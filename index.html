<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Управление автосалоном</title>
  <script src="https://cdn.jsdelivr.net/npm/react@18.3.1/umd/react.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18.3.1/umd/react-dom.production.min.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&display=swap');
    body{font-family:'Roboto Mono',monospace}.neon-border-dark{box-shadow:0 0 5px #ff0000,0 0 20px #ff0000,0 0 30px #ff0000}.neon-text-dark{text-shadow:0 0 5px #ff0000,0 0 10px #ff0000}.neon-border-light{box-shadow:0 0 5px #ff3333,0 0 20px #ff3333,0 0 30px #ff3333}.neon-text-light{text-shadow:0 0 5px #ff3333,0 0 10px #ff3333}.hover-neon:hover{box-shadow:0 0 10px #ff3333,0 0 20px #ff3333;transition:all .3s ease}.table-container{overflow-x:auto;-webkit-overflow-scrolling:touch}table{min-width:700px}th,td{font-size:.75rem;padding:.5rem}@media (min-width:640px){th,td{font-size:.875rem;padding:.75rem}}.modal-content{width:90%;max-width:400px}input,select,textarea{font-size:.875rem}.dark-theme{background-color:#1a1a1a;color:#fff}.light-theme{background-color:#f5f5f5;color:#1a1a1a}.error-message{background-color:#ff3333;color:#fff;padding:1rem;border-radius:.5rem;text-align:center}.container{max-width:1280px;margin-left:auto;margin-right:auto;padding-left:1rem;padding-right:1rem}.mx-auto{margin-left:auto;margin-right:auto}.p-4{padding:1rem}.sm\:p-6{padding:1.5rem}.flex{display:flex}.justify-between{justify-content:space-between}.items-center{align-items:center}.mb-6{margin-bottom:1.5rem}.sm\:mb-8{margin-bottom:2rem}.text-2xl{font-size:1.5rem}.sm\:text-4xl{font-size:2.25rem}.font-bold{font-weight:700}.text-center{text-align:center}.px-3{padding-left:.75rem;padding-right:.75rem}.sm\:px-4{padding-left:1rem;padding-right:1rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.rounded{border-radius:.25rem}.text-sm{font-size:.875rem}.sm\:text-base{font-size:1rem}.bg-red-600{background-color:#dc2626}.text-white{color:#fff}.bg-gray-600{background-color:#4b5563}.grid{display:grid}.grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.sm\:grid-cols-5{grid-template-columns:repeat(5,minmax(0,1fr))}.gap-2{gap:.5rem}.sm\:gap-4{gap:1rem}.bg-gray-800{background-color:#1f2937}.bg-gray-200{background-color:#e5e7eb}.p-2{padding:.5rem}.border{border-width:1px}.border-gray-700{border-color:#374151}.border-gray-300{border-color:#d1d5db}.focus\:outline-none:focus{outline:2px solid transparent;outline-offset:2px}.focus\:ring-2:focus{--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;box-shadow:0 0 #0000,0 0 #0000,0 0 0 2px rgba(239,68,68,.5)}.focus\:ring-red-600:focus{--tw-ring-color:#dc2626}.flex-col{flex-direction:column}.sm\:flex-row{flex-direction:row}.table-auto{table-layout:auto}.border-collapse{border-collapse:collapse}.hover\:bg-gray-700:hover{background-color:#374151}.transition-colors{transition-property:color,background-color,border-color;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.bg-red-900{background-color:#7f1d1d}.text-red-500{color:#ef4444}.px-2{padding-left:.5rem;padding-right:.5rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.mr-1{margin-right:.25rem}.sm\:mr-2{margin-right:.5rem}.text-xs{font-size:.75rem}.bg-green-600{background-color:#16a34a}.fixed{position:fixed}.inset-0{top:0;right:0;bottom:0;left:0}.bg-black{background-color:#000}.bg-opacity-75{--tw-bg-opacity:.75}.max-h-64{max-height:16rem}.overflow-y-auto{overflow-y:auto}.mt-4{margin-top:1rem}.cursor-pointer{cursor:pointer}.ml-4{margin-left:1rem}
  </style>
</head>
<body>
  <div id="root"></div>
  <script>
    // Error Boundary Component
    class ErrorBoundary extends React.Component {
      constructor(props) {
        super(props);
        this.state = { error: null };
      }
      static getDerivedStateFromError(error) {
        return { error: error.message };
      }
      componentDidCatch(error, info) {
        console.error("ErrorBoundary caught:", error, info);
      }
      render() {
        if (this.state.error) {
          return React.createElement(
            "div",
            { className: "error-message" },
            this.state.error,
            React.createElement(
              "button",
              {
                onClick: () => this.setState({ error: null }),
                className: "ml-4 bg-gray-600 text-white px-2 py-1 rounded hover-neon text-sm"
              },
              "Закрыть"
            )
          );
        }
        return this.props.children;
      }
    }

    // Main App Component
    function App() {
      const [cars, setCars] = React.useState([]);
      const [showModal, setShowModal] = React.useState(false);
      const [editCar, setEditCar] = React.useState(null);
      const [showHistory, setShowHistory] = React.useState(null);
      const [formData, setFormData] = React.useState({
        id: null,
        brand: '',
        model: '',
        status: 'в наличии',
        rentPeriod: '',
        mileage: '',
        category: 'эконом',
        notes: '',
        history: []
      });
      const [filterStatus, setFilterStatus] = React.useState('все');
      const [filterCategory, setFilterCategory] = React.useState('все');
      const [searchQuery, setSearchQuery] = React.useState('');
      const [sortConfig, setSortConfig] = React.useState({ key: null, direction: 'asc' });
      const [theme, setTheme] = React.useState('dark');
      const [error, setError] = React.useState(null);

      // Load data from localStorage
      React.useEffect(() => {
        try {
          const savedCars = localStorage.getItem('cars');
          const savedTheme = localStorage.getItem('theme') || 'dark';
          if (savedCars) {
            setCars(JSON.parse(savedCars));
          }
          setTheme(savedTheme);
          document.body.className = savedTheme === 'dark' ? 'dark-theme' : 'light-theme';
        } catch (e) {
          setError('Ошибка загрузки данных. Пожалуйста, очистите localStorage и попробуйте снова.');
          console.error('localStorage load error:', e);
        }
      }, []);

      // Save data and theme to localStorage
      React.useEffect(() => {
        try {
          localStorage.setItem('cars', JSON.stringify(cars));
          localStorage.setItem('theme', theme);
          document.body.className = theme === 'dark' ? 'dark-theme' : 'light-theme';
        } catch (e) {
          setError('Ошибка сохранения данных. Проверьте доступное место в localStorage.');
          console.error('localStorage save error:', e);
        }
      }, [cars, theme]);

      // Handle form input changes
      function handleInputChange(e) {
        const { name, value } = e.target;
        setFormData({ ...formData, [name]: value });
      }

      // Calculate miles to next service
      function calculateMilesToService(mileage) {
        const mileageNum = parseInt(mileage) || 0;
        const nextService = Math.ceil(mileageNum / 10000) * 10000;
        return nextService - mileageNum;
      }

      // Add or edit car
      function handleSubmit(e) {
        e.preventDefault();
        try {
          const rentPeriod = formData.rentPeriod;
          const isRented = rentPeriod && new Date(rentPeriod) > new Date();
          const newStatus = isRented ? 'в аренде' : 'в наличии';
          const currentDate = new Date().toISOString();
          const newHistory = [
            ...(editCar ? editCar.history : []),
            {
              action: editCar ? 'Редактирование' : 'Добавление',
              date: currentDate,
              details: editCar ? `Изменены данные` : `Добавлен автомобиль ${formData.brand} ${formData.model}`
            }
          ];
          const newCar = { ...formData, status: newStatus, history: newHistory, id: editCar ? editCar.id : Date.now() };
          if (editCar) {
            setCars(cars.map(car => car.id === editCar.id ? newCar : car));
          } else {
            setCars([...cars, newCar]);
          }
          setShowModal(false);
          setEditCar(null);
          setFormData({
            id: null,
            brand: '',
            model: '',
            status: 'в наличии',
            rentPeriod: '',
            mileage: '',
            category: 'эконом',
            notes: '',
            history: []
          });
        } catch (e) {
          setError('Ошибка при сохранении автомобиля. Попробуйте снова.');
          console.error('Submit error:', e);
        }
      }

      // Delete car
      function handleDelete(id) {
        if (window.confirm('Вы уверены, что хотите удалить этот автомобиль?')) {
          try {
            const car = cars.find(car => car.id === id);
            const newHistory = [
              ...car.history,
              { action: 'Удаление', date: new Date().toISOString(), details: `Автомобиль ${car.brand} ${car.model} удален` }
            ];
            setCars(cars.filter(car => car.id !== id));
            localStorage.setItem(`history_${id}`, JSON.stringify(newHistory));
          } catch (e) {
            setError('Ошибка при удалении автомобиля. Попробуйте снова.');
            console.error('Delete error:', e);
          }
        }
      }

      // Edit car
      function handleEdit(car) {
        setEditCar(car);
        setFormData(car);
        setShowModal(true);
      }

      // Sort table
      function handleSort(key) {
        const direction = sortConfig.key === key && sortConfig.direction === 'asc' ? 'desc' : 'asc';
        setSortConfig({ key, direction });
      }

      const sortedCars = [...cars].sort((a, b) => {
        if (!sortConfig.key) return 0;
        const aValue = sortConfig.key === 'milesToService' ? calculateMilesToService(a.mileage) : a[sortConfig.key];
        const bValue = sortConfig.key === 'milesToService' ? calculateMilesToService(b.mileage) : b[sortConfig.key];
        if (typeof aValue === 'string') {
          return sortConfig.direction === 'asc' ? aValue.localeCompare(bValue) : bValue.localeCompare(aValue);
        }
        return sortConfig.direction === 'asc' ? aValue - bValue : bValue - aValue;
      });

      // Filter and search
      const filteredCars = sortedCars.filter(car =>
        (filterStatus === 'все' || car.status === filterStatus) &&
        (filterCategory === 'все' || car.category === filterCategory) &&
        (car.brand.toLowerCase().includes(searchQuery.toLowerCase()) ||
         car.model.toLowerCase().includes(searchQuery.toLowerCase()))
      );

      // Statistics
      const stats = {
        total: cars.length,
        inStock: cars.filter(car => car.status === 'в наличии').length,
        rented: cars.filter(car => car.status === 'в аренде').length,
        sold: cars.filter(car => car.status === 'продан').length,
        nearestService: Math.min(...cars.map(car => calculateMilesToService(car.mileage)) || Infinity)
      };

      // Toggle theme
      function toggleTheme() {
        setTheme(theme === 'dark' ? 'light' : 'dark');
      }

      // Render
      return React.createElement(
        ErrorBoundary,
        null,
        React.createElement(
          "div",
          { className: "container mx-auto p-4 sm:p-6" },
          error && React.createElement(
            "div",
            { className: "error-message mb-4" },
            error,
            React.createElement(
              "button",
              {
                onClick: () => setError(null),
                className: "ml-4 bg-gray-600 text-white px-2 py-1 rounded hover-neon text-sm"
              },
              "Закрыть"
            )
          ),
          React.createElement(
            "div",
            { className: "flex justify-between items-center mb-6 sm:mb-8" },
            React.createElement(
              "h1",
              { className: `text-2xl sm:text-4xl font-bold text-center ${theme === 'dark' ? 'neon-text-dark' : 'neon-text-light'}` },
              "Управление автосалоном"
            ),
            React.createElement(
              "button",
              {
                onClick: toggleTheme,
                className: `px-3 sm:px-4 py-2 rounded text-sm sm:text-base ${theme === 'dark' ? 'bg-red-600 text-white' : 'bg-gray-600 text-white'} hover-neon`
              },
              theme === 'dark' ? 'Светлая тема' : 'Темная тема'
            )
          ),
          React.createElement(
            "div",
            { className: `grid grid-cols-2 sm:grid-cols-5 gap-2 sm:gap-4 mb-6 sm:mb-8 ${theme === 'dark' ? 'bg-gray-800' : 'bg-gray-200'} p-4 rounded-lg ${theme === 'dark' ? 'neon-border-dark' : 'neon-border-light'}` },
            React.createElement(
              "div",
              { className: "text-center" },
              React.createElement("p", { className: "text-sm sm:text-base" }, "Всего"),
              React.createElement("p", { className: "text-lg sm:text-xl font-bold" }, stats.total)
            ),
            React.createElement(
              "div",
              { className: "text-center" },
              React.createElement("p", { className: "text-sm sm:text-base" }, "В наличии"),
              React.createElement("p", { className: "text-lg sm:text-xl font-bold" }, stats.inStock)
            ),
            React.createElement(
              "div",
              { className: "text-center" },
              React.createElement("p", { className: "text-sm sm:text-base" }, "В аренде"),
              React.createElement("p", { className: "text-lg sm:text-xl font-bold" }, stats.rented)
            ),
            React.createElement(
              "div",
              { className: "text-center" },
              React.createElement("p", { className: "text-sm sm:text-base" }, "Проданы"),
              React.createElement("p", { className: "text-lg sm:text-xl font-bold" }, stats.sold)
            ),
            React.createElement(
              "div",
              { className: "text-center" },
              React.createElement("p", { className: "text-sm sm:text-base" }, "Ближайшее ТО (км)"),
              React.createElement("p", { className: "text-lg sm:text-xl font-bold" }, stats.nearestService === Infinity ? '-' : stats.nearestService)
            )
          ),
          React.createElement(
            "div",
            { className: "flex flex-col sm:flex-row gap-2 sm:gap-4 mb-4" },
            React.createElement(
              "select",
              {
                value: filterStatus,
                onChange: e => setFilterStatus(e.target.value),
                className: `p-2 ${theme === 'dark' ? 'bg-gray-800 border-gray-700' : 'bg-gray-200 border-gray-300'} border rounded focus:outline-none focus:ring-2 focus:ring-red-600 text-sm sm:text-base`
              },
              React.createElement("option", { value: "все" }, "Все статусы"),
              React.createElement("option", { value: "в наличии" }, "В наличии"),
              React.createElement("option", { value: "в аренде" }, "В аренде"),
              React.createElement("option", { value: "продан" }, "Продан")
            ),
            React.createElement(
              "select",
              {
                value: filterCategory,
                onChange: e => setFilterCategory(e.target.value),
                className: `p-2 ${theme === 'dark' ? 'bg-gray-800 border-gray-700' : 'bg-gray-200 border-gray-300'} border rounded focus:outline-none focus:ring-2 focus:ring-red-600 text-sm sm:text-base`
              },
              React.createElement("option", { value: "все" }, "Все категории"),
              React.createElement("option", { value: "эконом" }, "Эконом"),
              React.createElement("option", { value: "премиум" }, "Премиум"),
              React.createElement("option", { value: "внедорожник" }, "Внедорожник")
            ),
            React.createElement(
              "input",
              {
                type: "text",
                placeholder: "Поиск по марке или модели...",
                value: searchQuery,
                onChange: e => setSearchQuery(e.target.value),
                className: `p-2 ${theme === 'dark' ? 'bg-gray-800 border-gray-700' : 'bg-gray-200 border-gray-300'} border rounded focus:outline-none focus:ring-2 focus:ring-red-600 text-sm sm:text-base`
              }
            ),
            React.createElement(
              "button",
              {
                onClick: () => setShowModal(true),
                className: "bg-red-600 text-white px-4 py-2 rounded hover-neon text-sm sm:text-base"
              },
              "Добавить автомобиль"
            )
          ),
          React.createElement(
            "div",
            { className: "table-container" },
            React.createElement(
              "table",
              { className: "w-full table-auto border-collapse" },
              React.createElement(
                "thead",
                null,
                React.createElement(
                  "tr",
                  { className: theme === 'dark' ? 'bg-gray-800' : 'bg-gray-200' },
                  React.createElement("th", { className: "border border-gray-700 cursor-pointer", onClick: () => handleSort('brand') }, "Марка ", sortConfig.key === 'brand' && (sortConfig.direction === 'asc' ? '↑' : '↓')),
                  React.createElement("th", { className: "border border-gray-700 cursor-pointer", onClick: () => handleSort('model') }, "Модель ", sortConfig.key === 'model' && (sortConfig.direction === 'asc' ? '↑' : '↓')),
                  React.createElement("th", { className: "border border-gray-700 cursor-pointer", onClick: () => handleSort('category') }, "Категория ", sortConfig.key === 'category' && (sortConfig.direction === 'asc' ? '↑' : '↓')),
                  React.createElement("th", { className: "border border-gray-700 cursor-pointer", onClick: () => handleSort('status') }, "Статус ", sortConfig.key === 'status' && (sortConfig.direction === 'asc' ? '↑' : '↓')),
                  React.createElement("th", { className: "border border-gray-700 cursor-pointer", onClick: () => handleSort('rentPeriod') }, "Срок аренды ", sortConfig.key === 'rentPeriod' && (sortConfig.direction === 'asc' ? '↑' : '↓')),
                  React.createElement("th", { className: "border border-gray-700 cursor-pointer", onClick: () => handleSort('mileage') }, "Пробег (км) ", sortConfig.key === 'mileage' && (sortConfig.direction === 'asc' ? '↑' : '↓')),
                  React.createElement("th", { className: "border border-gray-700 cursor-pointer", onClick: () => handleSort('milesToService') }, "До ТО (км) ", sortConfig.key === 'milesToService' && (sortConfig.direction === 'asc' ? '↑' : '↓')),
                  React.createElement("th", { className: "border border-gray-700" }, "Примечания"),
                  React.createElement("th", { className: "border border-gray-700" }, "Действия")
                )
              ),
              React.createElement(
                "tbody",
                null,
                filteredCars.map(car =>
                  React.createElement(
                    "tr",
                    {
                      key: car.id,
                      className: `hover:bg-gray-700 transition-colors ${calculateMilesToService(car.mileage) < 1000 ? 'bg-red-900' : ''}`
                    },
                    React.createElement("td", { className: "border border-gray-700" }, car.brand),
                    React.createElement("td", { className: "border border-gray-700" }, car.model),
                    React.createElement("td", { className: "border border-gray-700" }, car.category),
                    React.createElement("td", { className: "border border-gray-700" }, car.status),
                    React.createElement("td", { className: "border border-gray-700" }, car.rentPeriod),
                    React.createElement("td", { className: "border border-gray-700" }, car.mileage),
                    React.createElement(
                      "td",
                      { className: `border border-gray-700 ${calculateMilesToService(car.mileage) < 1000 ? 'text-red-500 neon-text-dark' : ''}` },
                      calculateMilesToService(car.mileage)
                    ),
                    React.createElement("td", { className: "border border-gray-700" }, car.notes),
                    React.createElement(
                      "td",
                      { className: "border border-gray-700" },
                      React.createElement(
                        "button",
                        {
                          onClick: () => handleEdit(car),
                          className: "bg-blue-600 text-white px-2 py-1 rounded mr-1 sm:mr-2 hover-neon text-xs sm:text-sm"
                        },
                        "Редактировать"
                      ),
                      React.createElement(
                        "button",
                        {
                          onClick: () => handleDelete(car.id),
                          className: "bg-red-600 text-white px-2 py-1 rounded mr-1 sm:mr-2 hover-neon text-xs sm:text-sm"
                        },
                        "Удалить"
                      ),
                      React.createElement(
                        "button",
                        {
                          onClick: () => setShowHistory(car),
                          className: "bg-green-600 text-white px-2 py-1 rounded hover-neon text-xs sm:text-sm"
                        },
                        "История"
                      )
                    )
                  )
                )
              )
            )
          ),
          showModal && React.createElement(
            "div",
            { className: "fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center" },
            React.createElement(
              "div",
              { className: `modal-content ${theme === 'dark' ? 'bg-gray-900' : 'bg-gray-100'} p-4 sm:p-6 rounded-lg ${theme === 'dark' ? 'neon-border-dark' : 'neon-border-light'}` },
              React.createElement(
                "h2",
                { className: `text-xl sm:text-2xl mb-4 ${theme === 'dark' ? 'neon-text-dark' : 'neon-text-light'}` },
                editCar ? 'Редактировать автомобиль' : 'Добавить автомобиль'
              ),
              React.createElement(
                "form",
                { onSubmit: handleSubmit },
                React.createElement(
                  "div",
                  { className: "mb-3 sm:mb-4" },
                  React.createElement("label", { className: "block mb-1 text-sm sm:text-base" }, "Марка"),
                  React.createElement(
                    "input",
                    {
                      type: "text",
                      name: "brand",
                      value: formData.brand,
                      onChange: handleInputChange,
                      className: `w-full p-2 ${theme === 'dark' ? 'bg-gray-800 border-gray-700' : 'bg-gray-200 border-gray-300'} border rounded focus:outline-none focus:ring-2 focus:ring-red-600`,
                      required: true
                    }
                  )
                ),
                React.createElement(
                  "div",
                  { className: "mb-3 sm:mb-4" },
                  React.createElement("label", { className: "block mb-1 text-sm sm:text-base" }, "Модель"),
                  React.createElement(
                    "input",
                    {
                      type: "text",
                      name: "model",
                      value: formData.model,
                      onChange: handleInputChange,
                      className: `w-full p-2 ${theme === 'dark' ? 'bg-gray-800 border-gray-700' : 'bg-gray-200 border-gray-300'} border rounded focus:outline-none focus:ring-2 focus:ring-red-600`,
                      required: true
                    }
                  )
                ),
                React.createElement(
                  "div",
                  { className: "mb-3 sm:mb-4" },
                  React.createElement("label", { className: "block mb-1 text-sm sm:text-base" }, "Категория"),
                  React.createElement(
                    "select",
                    {
                      name: "category",
                      value: formData.category,
                      onChange: handleInputChange,
                      className: `w-full p-2 ${theme === 'dark' ? 'bg-gray-800 border-gray-700' : 'bg-gray-200 border-gray-300'} border rounded focus:outline-none focus:ring-2 focus:ring-red-600`
                    },
                    React.createElement("option", { value: "эконом" }, "Эконом"),
                    React.createElement("option", { value: "премиум" }, "Премиум"),
                    React.createElement("option", { value: "внедорожник" }, "Внедорожник")
                  )
                ),
                React.createElement(
                  "div",
                  { className: "mb-3 sm:mb-4" },
                  React.createElement("label", { className: "block mb-1 text-sm sm:text-base" }, "Срок аренды"),
                  React.createElement(
                    "input",
                    {
                      type: "date",
                      name: "rentPeriod",
                      value: formData.rentPeriod,
                      onChange: handleInputChange,
                      className: `w-full p-2 ${theme === 'dark' ? 'bg-gray-800 border-gray-700' : 'bg-gray-200 border-gray-300'} border rounded focus:outline-none focus:ring-2 focus:ring-red-600`
                    }
                  )
                ),
                React.createElement(
                  "div",
                  { className: "mb-3 sm:mb-4" },
                  React.createElement("label", { className: "block mb-1 text-sm sm:text-base" }, "Пробег (км)"),
                  React.createElement(
                    "input",
                    {
                      type: "number",
                      name: "mileage",
                      value: formData.mileage,
                      onChange: handleInputChange,
                      className: `w-full p-2 ${theme === 'dark' ? 'bg-gray-800 border-gray-700' : 'bg-gray-200 border-gray-300'} border rounded focus:outline-none focus:ring-2 focus:ring-red-600`
                    }
                  )
                ),
                React.createElement(
                  "div",
                  { className: "mb-3 sm:mb-4" },
                  React.createElement("label", { className: "block mb-1 text-sm sm:text-base" }, "Примечания"),
                  React.createElement(
                    "textarea",
                    {
                      name: "notes",
                      value: formData.notes,
                      onChange: handleInputChange,
                      className: `w-full p-2 ${theme === 'dark' ? 'bg-gray-800 border-gray-700' : 'bg-gray-200 border-gray-300'} border rounded focus:outline-none focus:ring-2 focus:ring-red-600`
                    }
                  )
                ),
                React.createElement(
                  "div",
                  { className: "flex justify-end" },
                  React.createElement(
                    "button",
                    {
                      type: "button",
                      onClick: () => setShowModal(false),
                      className: `bg-gray-600 text-white px-3 sm:px-4 py-2 rounded mr-1 sm:mr-2 hover-neon text-sm sm:text-base`
                    },
                    "Отмена"
                  ),
                  React.createElement(
                    "button",
                    {
                      type: "submit",
                      className: "bg-red-600 text-white px-3 sm:px-4 py-2 rounded hover-neon text-sm sm:text-base"
                    },
                    editCar ? 'Сохранить' : 'Добавить'
                  )
                )
              )
            )
          ),
          showHistory && React.createElement(
            "div",
            { className: "fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center" },
            React.createElement(
              "div",
              { className: `modal-content ${theme === 'dark' ? 'bg-gray-900' : 'bg-gray-100'} p-4 sm:p-6 rounded-lg ${theme === 'dark' ? 'neon-border-dark' : 'neon-border-light'}` },
              React.createElement(
                "h2",
                { className: `text-xl sm:text-2xl mb-4 ${theme === 'dark' ? 'neon-text-dark' : 'neon-text-light'}` },
                `История: ${showHistory.brand} ${showHistory.model}`
              ),
              React.createElement(
                "div",
                { className: "max-h-64 overflow-y-auto" },
                showHistory.history.map((entry, index) =>
                  React.createElement(
                    "div",
                    { key: index, className: "mb-2" },
                    React.createElement("p", { className: "text-sm" }, React.createElement("strong", null, entry.action), ` (${new Date(entry.date).toLocaleString()}):`),
                    React.createElement("p", { className: "text-sm" }, entry.details)
                  )
                )
              ),
              React.createElement(
                "div",
                { className: "flex justify-end mt-4" },
                React.createElement(
                  "button",
                  {
                    onClick: () => setShowHistory(null),
                    className: "bg-gray-600 text-white px-3 sm:px-4 py-2 rounded hover-neon text-sm sm:text-base"
                  },
                  "Закрыть"
                )
              )
            )
          )
        )
      );
    }

    // Render with error handling
    try {
      ReactDOM.render(
        React.createElement(App),
        document.getElementById('root')
      );
    } catch (e) {
      document.getElementById('root').innerHTML = `
        <div class="error-message">
          Ошибка загрузки приложения: ${e.message}. Пожалуйста, проверьте подключение к интернету и обновите страницу.
        </div>
      `;
      console.error('Render error:', e);
    }
  </script>
</body>
</html>
